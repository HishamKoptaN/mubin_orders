name: Build APKs
on:
  push:
    branches:
      - main
jobs:
  build:
    if: contains(github.event.head_commit.message, 'build')
    runs-on: ubuntu-latest
    steps:
      #! 1. التحقق من الكود
      - name: التحقق من الكود
        uses: actions/checkout@v4
      #! 2. إعداد JDK
      - name: إعداد JDK
        uses: actions/setup-java@v2
        with:
          java-version: '17'
          distribution: 'temurin'
      #! 3. إعداد فلاتر
      - name: إعداد فلاتر
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.0.0'
          channel: stable
          architecture: x64
          cache: false
          pub-cache-path: default
          dry-run: false
      - name: Upgrade Flutter
        run: flutter upgrade
      - name: فحص بيئة فلاتر
        run: flutter doctor  
      #! 4. تحميل التبعيات
      - name: تحميل التبعيات
        run: flutter pub get
      - name: تنظيف المشروع
        run: flutter clean
      #! 5. بناء نسخ الاندرويد
      - name: بناء نسخ الاندرويد
        run: flutter build apk --split-per-abi